<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Evan Luthra Investments</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>

<header class="hero">
  <img src="assets/banner.jpeg" class="banner" />

  <div class="hero-content">
    <img src="assets/logo.avif" class="hero-logo" />

    <h1>Evan Luthra Investments</h1>

    <ul class="socials">
      <li>ğŸ“¸ Instagram: <a href="https://instagram.com/EvanLuthra" target="_blank">instagram.com/EvanLuthra</a></li>
      <li>ğŸ¦ Twitter: <a href="https://x.com/evanluthra" target="_blank">x.com/evanluthra</a></li>
      <li>âœˆï¸ Telegram: <a href="https://t.me/EvanLuthraVIP" target="_blank">t.me/EvanLuthraVIP</a></li>
      <li>ğŸŒ Explore: <a href="https://evanluthra.com" target="_blank">evanluthra.com</a></li>
    </ul>

    <p class="contact">
      If you would like an intro to any of these deals, feel free to reach out directly on email
      <a href="mailto:Evan@EvanLuthra.com">Evan@EvanLuthra.com</a>
    </p>

    <p class="updated">Last Updated: 30th December, 2024</p>

    <button id="darkToggle" class="dark-toggle">ğŸŒ™</button>
  </div>
</header>

<hr />

<h2>ğŸ’² Portfolio</h2>

<div class="controls">
  <input type="text" id="search" placeholder="Search projectsâ€¦" />

  <select id="categoryFilter">
    <option value="">All Categories</option>
  </select>

  <select id="sort">
    <option value="">Sort</option>
    <option value="az">Name Aâ€“Z</option>
    <option value="za">Name Zâ€“A</option>
    <option value="date">Newest</option>
  </select>
</div>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Website</th>
      <th>Category</th>
      <th>Twitter</th>
      <th>Company Intro</th>
    </tr>
  </thead>
  <tbody id="portfolio"></tbody>
</table>

<div class="pagination">
  <button id="prevPage">Prev</button>
  <span id="pageInfo"></span>
  <button id="nextPage">Next</button>
</div>

<!-- DATA -->
<script src="data.js"></script>

<script>
document.addEventListener("DOMContentLoaded", () => {

  /* ------------------ CONFIG ------------------ */
  let currentPage = 1;
  const PAGE_SIZE = 10;

  const ADMIN_KEY = "admin_projects";
  const safeProjects = localStorage.getItem(ADMIN_KEY)
    ? JSON.parse(localStorage.getItem(ADMIN_KEY))
    : projects;

  /* ------------------ DARK MODE ------------------ */
  const toggle = document.getElementById("darkToggle");
  if (localStorage.getItem("dark") === "true") {
    document.body.classList.add("dark");
  }
  toggle.onclick = () => {
    document.body.classList.toggle("dark");
    localStorage.setItem("dark", document.body.classList.contains("dark"));
  };

  /* ------------------ ELEMENTS ------------------ */
  const table = document.getElementById("portfolio");
  const search = document.getElementById("search");
  const filter = document.getElementById("categoryFilter");
  const sort = document.getElementById("sort");

  /* ------------------ CATEGORY COLORS ------------------ */
  const CATEGORY_COLORS = {
    DePIN: "#e0f7fa",
    Wallet: "#e3f2fd",
    AI: "#fce4ec",
    DApp: "#e8f5e9",
    "Cross Chain": "#fff3e0",
    L1: "#ede7f6",
    Restaking: "#f1f8e9",
    Connectivity: "#f9fbe7",
    "Liquid Staking": "#ede7f6",
    defi: "#f3e5f5"
  };

  /* ------------------ POPULATE FILTER ------------------ */
  const cats = new Set();
  safeProjects.forEach(p => p.category.forEach(c => cats.add(c)));
  cats.forEach(c => {
    const opt = document.createElement("option");
    opt.value = c;
    opt.textContent = c;
    filter.appendChild(opt);
  });

  /* ------------------ RENDER ------------------ */
  function render() {
    let list = [...safeProjects];

    const q = search.value.toLowerCase();
    if (q) {
      list = list.filter(p =>
        p.name.toLowerCase().includes(q) ||
        p.intro.toLowerCase().includes(q)
      );
    }

    if (filter.value) {
      list = list.filter(p => p.category.includes(filter.value));
    }

    if (sort.value === "az") {
      list.sort((a,b) => a.name.localeCompare(b.name));
    } else if (sort.value === "za") {
      list.sort((a,b) => b.name.localeCompare(a.name));
    } else if (sort.value === "date") {
      list.sort((a,b) => new Date(b.date) - new Date(a.date));
    }

    const totalPages = Math.ceil(list.length / PAGE_SIZE) || 1;
    currentPage = Math.min(Math.max(1, currentPage), totalPages);

    const start = (currentPage - 1) * PAGE_SIZE;
    const pageItems = list.slice(start, start + PAGE_SIZE);

    table.innerHTML = "";

    pageItems.forEach(p => {
      table.innerHTML += `
        <tr>
          <td>
            <img src="${p.icon}" class="icon">
            <a href="project.html?id=${p.id}">${p.name}</a>
          </td>
          <td>
            <a href="${p.website}" target="_blank">
              ${p.website.replace("https://","")}
            </a>
          </td>
          <td>
            ${p.category.map(c =>
              `<span class="tag" style="background:${CATEGORY_COLORS[c] || '#eee'}">${c}</span>`
            ).join(" ")}
          </td>
          <td>
            <a href="${p.twitter}" target="_blank">x.com</a>
          </td>
          <td>${p.intro}</td>
        </tr>
      `;
    });

    document.getElementById("pageInfo").textContent =
      `Page ${currentPage} of ${totalPages}`;
  }

  /* ------------------ EVENTS ------------------ */
  search.oninput = () => { currentPage = 1; render(); };
  filter.onchange = () => { currentPage = 1; render(); };
  sort.onchange   = () => { currentPage = 1; render(); };

  document.getElementById("prevPage").onclick = () => {
    currentPage--;
    render();
  };

  document.getElementById("nextPage").onclick = () => {
    currentPage++;
    render();
  };

  render();
});
</script>

</body>
</html>
